import './polyfills.server.mjs';
import{a as E,b as L,c as W,d as j,e as z,f as N,j as R,l as H}from"./chunk-4AQZEVAQ.mjs";import{$ as m,E as O,K as l,O as c,Q as y,U as h,Ua as P,Wa as w,Za as M,aa as i,ba as a,ca as v,ha as g,hb as I,ja as _,na as s,nb as S,oa as C,pa as b,qa as d,qb as k,ra as f,rb as T,sa as u,ub as V,va as x}from"./chunk-57VKGGXC.mjs";import"./chunk-T55IDOPT.mjs";var B=()=>["/reset-init-7a2"];function D(p,o){if(p&1&&(i(0,"div",19),s(1),a()),p&2){let r=_();l(),b(" ",r.errorMessage," ")}}function F(p,o){if(p&1&&(i(0,"p",20),s(1),a()),p&2){let r=_();l(),C(r.email)}}var A=class p{constructor(o,r,e,n,t){this.http=o;this.router=r;this.route=e;this.loadingService=n;this.platformId=t}otp=["","","",""];email="";errorMessage="";otpId=null;isInHome=!1;ngOnInit(){if(M(this.platformId)){let o=window.history.state;if(o&&o.flow==="inhome")this.isInHome=!0,localStorage.setItem("flow","inhome");else{let n=localStorage.getItem("flow");this.isInHome=n==="inhome"}let r=localStorage.getItem("rootUserId"),e=localStorage.getItem("otpId");if(r&&!e&&!this.isInHome){this.router.navigate(["/root-home-v2b"]);return}this.email=localStorage.getItem("resetEmail")||"",this.otpId=e,this.otpId||this.router.navigate(["/reset-init-7a2"])}this.route.queryParams.subscribe(o=>{o.flow==="inhome"&&(this.isInHome=!0,M(this.platformId)&&localStorage.setItem("flow","inhome"))})}onOtpChange(o,r){if(o.target.value&&r<3){let n=o.target.nextElementSibling;n&&n.focus()}}onVerify(){let o=this.otp.join("");if(o.length<4||!this.otpId)return;this.loadingService.show();let r=`http://localhost:8000/be/rootUser/validation?id=${this.otpId}&value=${o}`;this.http.get(r,{responseType:"text"}).subscribe({next:e=>{this.loadingService.hide();let n=e&&e.replace(/^"|"$/g,"").trim();n==="OTP verified successfully"?this.router.navigate(["/upd-cred-3f4"]):n==="OTP was wrong"?this.errorMessage="OTP was wrong":n==="OTP expired try again"?(this.errorMessage="OTP expired try again",setTimeout(()=>{this.router.navigate(["/reset-init-7a2"])},2e3)):this.errorMessage=n},error:e=>{this.loadingService.hide(),console.error("OTP verification error",e),this.errorMessage="An error occurred. Please try again."}})}static \u0275fac=function(r){return new(r||p)(c(I),c(k),c(S),c(V),c(O))};static \u0275cmp=y({type:p,selectors:[["app-otp-verification"]],decls:26,vars:9,consts:[[1,"otp-wrapper"],["routerLink","/auth-v1",1,"back-link"],[1,"material-symbols-rounded"],[1,"logo-area"],["src","assets/logo.png","alt","OfficeWing Logo",1,"logo"],[1,"content-container"],["class","error-message",4,"ngIf"],[1,"page-title"],[1,"subtitle"],["class","email-display",4,"ngIf"],[1,"otp-form",3,"ngSubmit"],[1,"otp-inputs"],["type","text","maxlength","1","name","otp0","autofocus","",3,"ngModelChange","input","ngModel"],["type","text","maxlength","1","name","otp1",3,"ngModelChange","input","ngModel"],["type","text","maxlength","1","name","otp2",3,"ngModelChange","input","ngModel"],["type","text","maxlength","1","name","otp3",3,"ngModelChange","input","ngModel"],["type","submit",1,"verify-btn",3,"disabled"],[1,"helper-text"],[1,"resend-link",3,"routerLink"],[1,"error-message"],[1,"email-display"]],template:function(r,e){r&1&&(i(0,"div",0)(1,"button",1)(2,"span",2),s(3,"arrow_back"),a(),s(4," Back "),a(),i(5,"div",3),v(6,"img",4),a(),i(7,"div",5),h(8,D,2,1,"div",6),i(9,"h1",7),s(10,"Enter OTP"),a(),i(11,"p",8),s(12,"Enter the OTP sent to your email"),a(),h(13,F,2,1,"p",9),i(14,"form",10),g("ngSubmit",function(){return e.onVerify()}),i(15,"div",11)(16,"input",12),u("ngModelChange",function(t){return f(e.otp[0],t)||(e.otp[0]=t),t}),g("input",function(t){return e.onOtpChange(t,0)}),a(),i(17,"input",13),u("ngModelChange",function(t){return f(e.otp[1],t)||(e.otp[1]=t),t}),g("input",function(t){return e.onOtpChange(t,1)}),a(),i(18,"input",14),u("ngModelChange",function(t){return f(e.otp[2],t)||(e.otp[2]=t),t}),g("input",function(t){return e.onOtpChange(t,2)}),a(),i(19,"input",15),u("ngModelChange",function(t){return f(e.otp[3],t)||(e.otp[3]=t),t}),g("input",function(t){return e.onOtpChange(t,3)}),a()(),i(20,"button",16),s(21,"Verify"),a(),i(22,"div",17),s(23," Didn't receive the code? "),i(24,"a",18),s(25,"Resend OTP"),a()()()()()),r&2&&(l(8),m("ngIf",e.errorMessage),l(5),m("ngIf",e.email),l(3),d("ngModel",e.otp[0]),l(),d("ngModel",e.otp[1]),l(),d("ngModel",e.otp[2]),l(),d("ngModel",e.otp[3]),l(),m("disabled",e.otp.join("").length<4),l(4),m("routerLink",x(8,B)))},dependencies:[w,P,H,N,E,L,W,R,z,j,T],styles:["[_nghost-%COMP%]{display:block;font-family:Inter,sans-serif;background-color:#000;min-height:100vh;color:#fff}.otp-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;padding:2rem;box-sizing:border-box;align-items:center;justify-content:center;position:relative}.logo-area[_ngcontent-%COMP%]{position:absolute;top:2rem;right:2rem;width:auto}.logo-area[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{height:40px;width:auto}.content-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;max-width:450px;position:relative;padding-top:1rem}.back-link[_ngcontent-%COMP%]{position:absolute;top:2rem;left:2rem;display:flex;align-items:center;gap:.5rem;color:#aaa;text-decoration:none;font-size:.9rem;padding:0;background:transparent;border:none;cursor:pointer;transition:color .2s;z-index:100}.back-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px}.back-link[_ngcontent-%COMP%]:hover{color:#fff}@media(max-width:768px){.back-link[_ngcontent-%COMP%]{top:1rem;left:1rem}}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin-bottom:.5rem;text-align:center}.subtitle[_ngcontent-%COMP%]{color:#aaa;margin-bottom:.5rem;text-align:center;font-size:.95rem}.email-display[_ngcontent-%COMP%]{color:#fff;font-weight:500;margin-bottom:2rem;font-size:.95rem}.otp-form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;gap:2rem}.otp-inputs[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:center}.otp-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:55px;height:55px;background-color:#121212;border:1px solid #333333;border-radius:8px;color:#fff;font-size:1.5rem;text-align:center;outline:none;transition:border-color .2s}.otp-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#666}.error-message[_ngcontent-%COMP%]{color:#ff5252;font-size:.9rem;text-align:center;margin-bottom:1.5rem;width:100%}.verify-btn[_ngcontent-%COMP%]{width:100%;background-color:#fff;color:#000;border:none;border-radius:6px;padding:14px;font-size:1rem;font-weight:600;cursor:pointer;transition:opacity .2s}.verify-btn[_ngcontent-%COMP%]:hover{opacity:.9}.verify-btn[_ngcontent-%COMP%]:disabled{background-color:#555;color:#888;cursor:not-allowed;opacity:.7}.helper-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem;color:#aaa;font-size:.9rem;margin-top:2rem}.helper-text[_ngcontent-%COMP%]   .resend-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;font-weight:600}.helper-text[_ngcontent-%COMP%]   .resend-link[_ngcontent-%COMP%]:hover{text-decoration:underline}"]})};export{A as OtpVerification};
