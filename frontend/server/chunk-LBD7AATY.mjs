import './polyfills.server.mjs';
import{a as N,b as U,c as T,d as F,e as j,f as A,h as L,l as R}from"./chunk-4AQZEVAQ.mjs";import{$ as p,E as O,K as s,O as f,Q as y,U as _,Ua as k,Wa as I,Za as w,aa as n,ba as i,ga as E,ha as u,hb as S,ja as h,ma as b,na as r,oa as M,p as d,pa as C,q as c,qa as v,qb as V,ra as P,rb as z,sa as x,ub as D}from"./chunk-57VKGGXC.mjs";import"./chunk-T55IDOPT.mjs";function B(o,a){if(o&1&&(n(0,"div",21),r(1),i()),o&2){let e=h();s(),M(e.nameDisclaimer)}}function $(o,a){if(o&1&&(n(0,"div",21),r(1),i()),o&2){let e=h();s(),M(e.emailDisclaimer)}}function Z(o,a){if(o&1&&(n(0,"div",22)(1,"span",3),r(2,"error"),i(),r(3),i()),o&2){let e=h();s(3),C(" ",e.errorMessage," ")}}function q(o,a){if(o&1&&(n(0,"div",23)(1,"span",3),r(2,"check_circle"),i(),r(3),i()),o&2){let e=h();s(3),C(" ",e.successMessage," ")}}var W=class o{constructor(a,e,t,l){this.http=a;this.router=e;this.loadingService=t;this.platformId=l}rootUserId=null;originalName="";originalEmail="";name="";email="";nameDisclaimer="";emailDisclaimer="";errorMessage="";successMessage="";ngOnInit(){if(w(this.platformId)){if(this.rootUserId=localStorage.getItem("rootUserId"),!this.rootUserId){this.router.navigate(["/auth-v1"]);return}this.fetchUserDetails()}}fetchUserDetails(){this.loadingService.show();let a=`http://localhost:8000/be/rootUser/details?id=${this.rootUserId}`;this.http.get(a).subscribe({next:e=>{this.loadingService.hide(),this.name=e.name,this.email=e.email,this.originalName=e.name,this.originalEmail=e.email},error:e=>{this.loadingService.hide(),this.errorMessage="Failed to load user details",console.error(e)}})}validateName(){this.name&&!/^[A-Za-z\s]+$/.test(this.name)?this.nameDisclaimer="Name field only accepts letters only":this.nameDisclaimer=""}validateEmail(){this.email&&!/^[a-zA-Z0-9._%+-]+@gmail\.com$/.test(this.email)?this.emailDisclaimer="For now we only allow email end up with @gmail.com address":this.emailDisclaimer=""}isModified(){return this.name!==this.originalName||this.email!==this.originalEmail}isFormValid(){let a=/^[A-Za-z\s]+$/.test(this.name)&&this.name.length>0,e=/^[a-zA-Z0-9._%+-]+@gmail\.com$/.test(this.email);return a&&e&&this.isModified()}onUpdate(){if(!this.isFormValid())return;this.loadingService.show(),this.errorMessage="",this.successMessage="";let a=`http://localhost:8000/be/rootUser?id=${this.rootUserId}`;this.name!==this.originalName&&(a+=`&name=${encodeURIComponent(this.name)}`),this.email!==this.originalEmail&&(a+=`&mail=${encodeURIComponent(this.email)}`),this.http.put(a,{},{responseType:"text"}).subscribe({next:e=>{this.loadingService.hide();let t=e&&e.replace(/^"|"$/g,"").trim();t==="Profile edited successfully"?(this.successMessage=t,w(this.platformId)&&localStorage.setItem("rootUserName",this.name),setTimeout(()=>{this.router.navigate(["/root-home-v2b"])},2e3)):this.errorMessage=t},error:e=>{this.loadingService.hide(),this.errorMessage="An error occurred. Please try again.",console.error(e)}})}goBack(){this.router.navigate(["/root-home-v2b"])}static \u0275fac=function(e){return new(e||o)(f(S),f(V),f(D),f(O))};static \u0275cmp=y({type:o,selectors:[["app-edit-profile"]],decls:36,vars:11,consts:[["editForm","ngForm"],[1,"edit-profile-wrapper"],[1,"back-link",3,"click"],[1,"material-symbols-rounded"],[1,"edit-profile-card"],[1,"header"],[1,"subtitle"],[1,"edit-form",3,"ngSubmit"],[1,"input-group"],["for","name"],[1,"input-wrapper"],[1,"material-symbols-rounded","icon"],["type","text","id","name","name","name","placeholder","Enter your name","required","","autocomplete","name",3,"ngModelChange","input","ngModel"],["class","disclaimer",4,"ngIf"],["for","email"],["type","email","id","email","name","email","placeholder","Enter your email","required","","autocomplete","email",3,"ngModelChange","input","ngModel"],[1,"password-link-area"],["routerLink","/secure-upd-v4k",1,"password-link"],["class","message error",4,"ngIf"],["class","message success",4,"ngIf"],["type","submit",1,"submit-btn",3,"disabled"],[1,"disclaimer"],[1,"message","error"],[1,"message","success"]],template:function(e,t){if(e&1){let l=E();n(0,"div",1)(1,"button",2),u("click",function(){return d(l),c(t.goBack())}),n(2,"span",3),r(3,"arrow_back"),i(),r(4," Back "),i(),n(5,"div",4)(6,"header",5)(7,"h1"),r(8,"Edit Profile"),i(),n(9,"p",6),r(10,"Update your account information"),i()(),n(11,"form",7,0),u("ngSubmit",function(){return d(l),c(t.onUpdate())}),n(13,"div",8)(14,"label",9),r(15,"Full Name"),i(),n(16,"div",10)(17,"span",11),r(18,"person"),i(),n(19,"input",12),x("ngModelChange",function(m){return d(l),P(t.name,m)||(t.name=m),c(m)}),u("input",function(){return d(l),c(t.validateName())}),i()(),_(20,B,2,1,"div",13),i(),n(21,"div",8)(22,"label",14),r(23,"Email Address"),i(),n(24,"div",10)(25,"span",11),r(26,"mail"),i(),n(27,"input",15),x("ngModelChange",function(m){return d(l),P(t.email,m)||(t.email=m),c(m)}),u("input",function(){return d(l),c(t.validateEmail())}),i()(),_(28,$,2,1,"div",13),n(29,"div",16)(30,"a",17),r(31,"Want to change password? Click here"),i()()(),_(32,Z,4,1,"div",18)(33,q,4,1,"div",19),n(34,"button",20),r(35," Edit Change "),i()()()()}e&2&&(s(19),b("input-error",t.nameDisclaimer),v("ngModel",t.name),s(),p("ngIf",t.nameDisclaimer),s(7),b("input-error",t.emailDisclaimer),v("ngModel",t.email),s(),p("ngIf",t.emailDisclaimer),s(4),p("ngIf",t.errorMessage),s(),p("ngIf",t.successMessage),s(),p("disabled",!t.isFormValid()))},dependencies:[I,k,R,A,N,U,T,L,j,F,z],styles:["[_nghost-%COMP%]{display:block;font-family:Inter,sans-serif;background-color:#000;min-height:100vh;color:#fff}.edit-profile-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;padding:2rem;box-sizing:border-box;align-items:center;justify-content:center;position:relative}@media(max-width:768px){.edit-profile-wrapper[_ngcontent-%COMP%]{padding:2rem 1rem;justify-content:center}}.back-link[_ngcontent-%COMP%]{position:absolute;top:2rem;left:2rem;background:transparent;border:none;color:#aaa;display:flex;align-items:center;gap:.5rem;cursor:pointer;font-size:.9rem;padding:0;transition:color .2s;z-index:100}.back-link[_ngcontent-%COMP%]:hover{color:#fff}.back-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px}@media(max-width:768px){.back-link[_ngcontent-%COMP%]{top:1rem;left:1rem}}.edit-profile-card[_ngcontent-%COMP%]{width:100%;max-width:450px}.header[_ngcontent-%COMP%]{margin-bottom:2.5rem;text-align:center;position:relative;padding-top:1rem}@media(max-width:768px){.header[_ngcontent-%COMP%]{padding-top:2.5rem}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin-bottom:.5rem}.header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#aaa;font-size:.95rem}.edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;font-weight:500;color:#eee}.input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-wrapper[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#666;font-size:20px;pointer-events:none}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;background-color:#121212;border:1px solid #333333;border-radius:8px;padding:12px 12px 12px 40px;color:#fff;font-family:inherit;font-size:.95rem;outline:none;transition:all .2s;box-sizing:border-box}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#666;background-color:#1a1a1a}.input-wrapper[_ngcontent-%COMP%]   input.input-error[_ngcontent-%COMP%]{border-color:#ff5252!important}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#444}.password-link-area[_ngcontent-%COMP%]{margin-top:.4rem}.password-link-area[_ngcontent-%COMP%]   .password-link[_ngcontent-%COMP%]{color:#aaa;font-size:.85rem;text-decoration:none;transition:color .2s}.password-link-area[_ngcontent-%COMP%]   .password-link[_ngcontent-%COMP%]:hover{color:#fff;text-decoration:underline}.disclaimer[_ngcontent-%COMP%]{color:#ff5252;font-size:.8rem;margin-top:.2rem}.message[_ngcontent-%COMP%]{padding:1rem;border-radius:8px;font-size:.9rem;display:flex;align-items:center;gap:.8rem;margin-bottom:.5rem}.message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px}.message.error[_ngcontent-%COMP%]{background:#ff52521a;color:#ff5252;border:1px solid rgba(255,82,82,.2)}.message.success[_ngcontent-%COMP%]{background:#4caf501a;color:#4caf50;border:1px solid rgba(76,175,80,.2)}.submit-btn[_ngcontent-%COMP%]{width:100%;background-color:#fff;color:#000;border:none;border-radius:8px;padding:14px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s;margin-top:.5rem}.submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){opacity:.9;transform:translateY(-2px)}.submit-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.submit-btn[_ngcontent-%COMP%]:disabled{background-color:#222;color:#555;cursor:not-allowed;opacity:.7}"]})};export{W as EditProfile};
