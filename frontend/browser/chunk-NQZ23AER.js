import{a as N,b as T,c as F,d as L,e as j,f as H,h as A,l as W}from"./chunk-6WJKHN4A.js";import{Aa as E,B as I,D as i,Ga as z,H as d,I as O,Ia as V,Ja as R,M as P,Ma as U,P as h,Q as r,R as t,S as y,W as S,X as _,Z as b,aa as c,ba as n,ca as g,da as v,ea as C,fa as M,ga as x,p as u,q as f,ta as k,va as q,wa as w}from"./chunk-W7FZ6OA6.js";function B(a,o){if(a&1&&(r(0,"div",22),n(1),t()),a&2){let s=b();i(),v(" ",s.errorMessage," ")}}function G(a,o){if(a&1&&(r(0,"div",23),n(1),t()),a&2){let s=b();i(),v(" ",s.successMessage," ")}}function Z(a,o){a&1&&(r(0,"div",24),n(1," Passwords do not match. "),t())}var D=class a{constructor(o,s,e,l,p){this.router=o;this.http=s;this.route=e;this.loadingService=l;this.platformId=p}newPassword="";confirmPassword="";errorMessage="";successMessage="";isInHome=!1;requirements={length:!1,upper:!1,lower:!1,number:!1,symbol:!1};ngOnInit(){if(w(this.platformId)){let o=window.history.state;if(o&&o.flow==="inhome")this.isInHome=!0,localStorage.setItem("flow","inhome");else{let e=localStorage.getItem("flow");this.isInHome=e==="inhome"}localStorage.getItem("rootUserId")&&!localStorage.getItem("otpId")&&!this.isInHome&&this.router.navigate(["/root-home-v2b"])}this.route.queryParams.subscribe(o=>{o.flow==="inhome"&&(this.isInHome=!0,w(this.platformId)&&localStorage.setItem("flow","inhome"))})}checkRequirements(){this.requirements.length=this.newPassword.length>=8&&this.newPassword.length<=16,this.requirements.upper=/[A-Z]/.test(this.newPassword),this.requirements.lower=/[a-z]/.test(this.newPassword),this.requirements.number=/[0-9]/.test(this.newPassword),this.requirements.symbol=/[!@#$%^&*(),.?":{}|<>]/.test(this.newPassword)}isFormValid(){return this.requirements.length&&this.requirements.upper&&this.requirements.lower&&this.requirements.number&&this.requirements.symbol&&this.newPassword===this.confirmPassword}onChangePassword(){if(!this.isFormValid())return;let o=null;if(w(this.platformId)&&(o=localStorage.getItem("tempResetUserId")),!o){this.errorMessage="Session error. Please try again from the beginning.";return}this.loadingService.show();let s=`http://localhost:8000/be/rootUser/change?id=${o}&password=${this.newPassword}`;this.http.put(s,{},{responseType:"text"}).subscribe({next:e=>{this.loadingService.hide();let l=e&&e.replace(/^"|"$/g,"").trim();l==="Password changes successfully"||l==="Password changed successfully"?(this.successMessage="Password changed successfully",this.errorMessage="",w(this.platformId)&&(localStorage.getItem("flow")==="inhome"?(localStorage.removeItem("otpId"),localStorage.removeItem("flow"),localStorage.removeItem("resetEmail"),localStorage.removeItem("tempResetUserId"),setTimeout(()=>{this.router.navigate(["/root-home-v2b"])},1500)):(localStorage.clear(),setTimeout(()=>{this.router.navigate(["/auth-v1"])},1500)))):(this.errorMessage=l,this.successMessage="")},error:e=>{this.loadingService.hide(),console.error("Change password error",e),this.errorMessage="An error occurred. Please try again."}})}static \u0275fac=function(s){return new(s||a)(d(V),d(E),d(z),d(U),d(I))};static \u0275cmp=O({type:a,selectors:[["app-change-password"]],decls:54,vars:21,consts:[["passwordForm","ngForm"],["newPassInput","ngModel"],["confirmPassInput","ngModel"],[1,"change-password-wrapper"],["routerLink","/auth-v1",1,"back-link"],[1,"material-symbols-rounded"],[1,"logo-area"],["src","assets/logo.png","alt","OfficeWing Logo",1,"logo"],[1,"content-container"],["class","error-message general-error",4,"ngIf"],["class","success-message",4,"ngIf"],[1,"page-title"],[1,"password-form",3,"ngSubmit"],[1,"form-group"],[1,"input-wrapper"],[1,"material-symbols-rounded","input-icon"],["type","password","name","newPassword","placeholder","New Password","required","",3,"ngModelChange","input","ngModel"],[1,"requirements-list"],[1,"requirement"],["type","password","name","confirmPassword","placeholder","Confirm New Password","required","",3,"ngModelChange","ngModel"],["class","error-message",4,"ngIf"],["type","submit",1,"submit-btn",3,"disabled"],[1,"error-message","general-error"],[1,"success-message"],[1,"error-message"]],template:function(s,e){if(s&1){let l=S();r(0,"div",3)(1,"button",4)(2,"span",5),n(3,"arrow_back"),t(),n(4," Back "),t(),r(5,"div",6),y(6,"img",7),t(),r(7,"div",8),P(8,B,2,1,"div",9)(9,G,2,1,"div",10),r(10,"h1",11),n(11,"Change Password"),t(),r(12,"form",12,0),_("ngSubmit",function(){return u(l),f(e.onChangePassword())}),r(14,"div",13)(15,"label"),n(16,"New Password"),t(),r(17,"div",14)(18,"span",15),n(19,"lock"),t(),r(20,"input",16,1),x("ngModelChange",function(m){return u(l),M(e.newPassword,m)||(e.newPassword=m),f(m)}),_("input",function(){return u(l),f(e.checkRequirements())}),t()(),r(22,"div",17)(23,"div",18)(24,"span",5),n(25),t(),n(26," 8-16 characters "),t(),r(27,"div",18)(28,"span",5),n(29),t(),n(30," One uppercase letter "),t(),r(31,"div",18)(32,"span",5),n(33),t(),n(34," One lowercase letter "),t(),r(35,"div",18)(36,"span",5),n(37),t(),n(38," One number "),t(),r(39,"div",18)(40,"span",5),n(41),t(),n(42," One special symbol "),t()()(),r(43,"div",13)(44,"label"),n(45,"Confirm Password"),t(),r(46,"div",14)(47,"span",15),n(48,"verified_user"),t(),r(49,"input",19,2),x("ngModelChange",function(m){return u(l),M(e.confirmPassword,m)||(e.confirmPassword=m),f(m)}),t()(),P(51,Z,2,0,"div",20),t(),r(52,"button",21),n(53,"Change Password"),t()()()()}s&2&&(i(8),h("ngIf",e.errorMessage),i(),h("ngIf",e.successMessage),i(11),C("ngModel",e.newPassword),i(3),c("valid",e.requirements.length),i(2),g(e.requirements.length?"check_box":"check_box_outline_blank"),i(2),c("valid",e.requirements.upper),i(2),g(e.requirements.upper?"check_box":"check_box_outline_blank"),i(2),c("valid",e.requirements.lower),i(2),g(e.requirements.lower?"check_box":"check_box_outline_blank"),i(2),c("valid",e.requirements.number),i(2),g(e.requirements.number?"check_box":"check_box_outline_blank"),i(2),c("valid",e.requirements.symbol),i(2),g(e.requirements.symbol?"check_box":"check_box_outline_blank"),i(8),C("ngModel",e.confirmPassword),i(2),h("ngIf",e.confirmPassword&&e.newPassword!==e.confirmPassword),i(),h("disabled",!e.isFormValid()))},dependencies:[q,k,W,H,N,T,F,A,j,L,R],styles:["[_nghost-%COMP%]{display:block;font-family:Inter,sans-serif;background-color:#000;min-height:100vh;color:#fff}.change-password-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;padding:2rem;box-sizing:border-box;align-items:center;justify-content:center;position:relative}.back-link[_ngcontent-%COMP%]{position:absolute;top:2rem;left:2rem;display:flex;align-items:center;gap:.5rem;color:#aaa;text-decoration:none;font-size:.9rem;padding:0;background:transparent;border:none;cursor:pointer;transition:color .2s;z-index:100}.back-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px}.back-link[_ngcontent-%COMP%]:hover{color:#fff}@media(max-width:768px){.back-link[_ngcontent-%COMP%]{top:1rem;left:1rem}}.logo-area[_ngcontent-%COMP%]{position:absolute;top:2rem;right:2rem;width:auto}.logo-area[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{height:40px;width:auto}@media(max-width:768px){.logo-area[_ngcontent-%COMP%]{display:none}}.content-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;max-width:400px;position:relative;padding-top:1rem}@media(max-width:768px){.content-container[_ngcontent-%COMP%]{margin-top:0}}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin-bottom:3rem;text-align:center}.password-form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:2rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.8rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.95rem;font-weight:500;color:#eee}.input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-wrapper[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#666;font-size:20px;pointer-events:none}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;background-color:#121212;border:1px solid #333333;border-radius:6px;padding:14px 12px 14px 40px;color:#fff;font-family:inherit;font-size:.95rem;outline:none;transition:border-color .2s;box-sizing:border-box}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#666}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#444}.input-wrapper[_ngcontent-%COMP%]   input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ff5252}.error-message[_ngcontent-%COMP%]{color:#ff5252;font-size:.8rem;margin-top:-.5rem;margin-bottom:2rem}.error-message.general-error[_ngcontent-%COMP%]{margin-top:0;text-align:center}.success-message[_ngcontent-%COMP%]{color:#4caf50;text-align:center;font-size:.9rem;font-weight:500;margin-bottom:2rem}.requirements-list[_ngcontent-%COMP%]{margin-top:1rem;display:flex;flex-wrap:wrap;gap:.8rem;background:#ffffff0d;padding:1rem;border-radius:8px}.requirements-list[_ngcontent-%COMP%]   .requirement[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;font-size:.75rem;color:#555;transition:color .2s}.requirements-list[_ngcontent-%COMP%]   .requirement[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.requirements-list[_ngcontent-%COMP%]   .requirement.valid[_ngcontent-%COMP%]{color:#4caf50}.submit-btn[_ngcontent-%COMP%]{width:100%;background-color:#fff;color:#000;border:none;border-radius:6px;padding:14px;font-size:1rem;font-weight:600;cursor:pointer;transition:opacity .2s;margin-top:1rem}.submit-btn[_ngcontent-%COMP%]:hover{opacity:.9}.submit-btn[_ngcontent-%COMP%]:disabled{background-color:#555;color:#888;cursor:not-allowed;opacity:.7}"]})};export{D as ChangePassword};
