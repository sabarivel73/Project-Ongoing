import{a as N,b as U,c as V,d as H,e as R,f as j,h as A,i as L,l as q}from"./chunk-6WJKHN4A.js";import{Aa as F,B as I,D as m,Ga as T,H as d,I as w,Ia as z,M as h,Ma as B,P as p,Q as o,R as i,S as x,W as P,X as _,Z as v,_ as b,aa as M,ba as l,da as C,ea as O,fa as S,ga as y,p as f,q as u,ta as E,va as k,wa as g}from"./chunk-W7FZ6OA6.js";function G(n,r){if(n&1&&(o(0,"div",18),l(1),i()),n&2){let e=v();M("error",e.isError)("success",!e.isError),m(),C(" ",e.message," ")}}function J(n,r){n&1&&(o(0,"span"),l(1,"Email is required."),i())}function K(n,r){n&1&&(o(0,"span"),l(1,"Please enter a valid email."),i())}function Q(n,r){if(n&1&&(o(0,"div",19),h(1,J,2,0,"span",20)(2,K,2,0,"span",20),i()),n&2){v();let e=b(20);m(),p("ngIf",e.errors==null?null:e.errors.required),m(),p("ngIf",e.errors==null?null:e.errors.email)}}var D=class n{constructor(r,e,t,a,s){this.http=r;this.router=e;this.route=t;this.loadingService=a;this.platformId=s}email="";message="";isError=!1;isInHome=!1;ngOnInit(){if(g(this.platformId)){let r=window.history.state;r&&r.flow==="inhome"?(this.isInHome=!0,localStorage.setItem("flow","inhome")):localStorage.getItem("flow")==="inhome"&&(this.isInHome=!0),localStorage.getItem("rootUserId")&&!localStorage.getItem("otpId")&&!this.isInHome&&this.router.navigate(["/root-home-v2b"])}this.route.queryParams.subscribe(r=>{r.flow==="inhome"&&(this.isInHome=!0,g(this.platformId)&&localStorage.setItem("flow","inhome"))})}onSendOtp(){if(!this.email)return;this.loadingService.show();let r=`http://localhost:8000/be/rootUser/mail?mail=${this.email}`;this.http.get(r,{responseType:"text"}).subscribe({next:e=>{this.loadingService.hide();let t=e&&e.replace(/^"|"$/g,"").trim();if(t==="Email not found")this.message="Email not found",this.isError=!0;else if(t==="For now we only allow email end up with @gmail.com address")this.message=t,this.isError=!0;else if(t&&t.includes("Mail sent successfully and Id :")){let a=t.match(/Id\s*:\s*(\d+)/i),s=t.match(/user_id\s*:\s*(\d+)/i);if(a&&s){let c=a[1],W=s[1];g(this.platformId)&&(localStorage.removeItem("rootUserId"),localStorage.removeItem("rootUserName"),localStorage.removeItem("iamUserId"),localStorage.setItem("otpId",c),localStorage.setItem("resetEmail",this.email),localStorage.setItem("tempResetUserId",W)),this.router.navigate(["/v-secure-9b1"])}else if(a){let c=a[1];g(this.platformId)&&(localStorage.removeItem("rootUserId"),localStorage.removeItem("rootUserName"),localStorage.removeItem("iamUserId"),localStorage.setItem("otpId",c),localStorage.setItem("resetEmail",this.email)),this.router.navigate(["/v-secure-9b1"])}}else this.message="Mail sent",this.isError=!1},error:e=>{this.loadingService.hide(),console.error("Error sending OTP",e),this.message="Error sending OTP. Please try again.",this.isError=!0}})}goBack(){this.isInHome?this.router.navigate(["/root-home-v2b"]):this.router.navigate(["/auth-v1"])}static \u0275fac=function(e){return new(e||n)(d(F),d(z),d(T),d(B),d(I))};static \u0275cmp=w({type:n,selectors:[["app-forgot-password"]],decls:24,vars:4,consts:[["otpForm","ngForm"],["emailInput","ngModel"],[1,"forgot-password-wrapper"],[1,"back-link",3,"click"],[1,"material-symbols-rounded"],[1,"logo-area"],["src","assets/logo.png","alt","OfficeWing Logo",1,"logo"],[1,"content-container"],["class","status-message",3,"error","success",4,"ngIf"],[1,"page-title"],[1,"subtitle"],[1,"otp-form",3,"ngSubmit"],[1,"form-group"],[1,"input-wrapper"],[1,"material-symbols-rounded","input-icon"],["type","email","name","email","placeholder","Email Address","required","","email","",3,"ngModelChange","ngModel"],["class","error-message",4,"ngIf"],["type","submit",1,"submit-btn",3,"disabled"],[1,"status-message"],[1,"error-message"],[4,"ngIf"]],template:function(e,t){if(e&1){let a=P();o(0,"div",2)(1,"button",3),_("click",function(){return f(a),u(t.goBack())}),o(2,"span",4),l(3,"arrow_back"),i(),l(4," Back "),i(),o(5,"div",5),x(6,"img",6),i(),o(7,"div",7),h(8,G,2,5,"div",8),o(9,"h1",9),l(10,"Enter Email"),i(),o(11,"p",10),l(12,"Enter the email associated with your account to receive an OTP."),i(),o(13,"form",11,0),_("ngSubmit",function(){return f(a),u(t.onSendOtp())}),o(15,"div",12)(16,"div",13)(17,"span",14),l(18,"mail"),i(),o(19,"input",15,1),y("ngModelChange",function(c){return f(a),S(t.email,c)||(t.email=c),u(c)}),i()(),h(21,Q,3,2,"div",16),i(),o(22,"button",17),l(23,"Send OTP"),i()()()()}if(e&2){let a=b(14),s=b(20);m(8),p("ngIf",t.message),m(11),O("ngModel",t.email),m(2),p("ngIf",s.invalid&&(s.dirty||s.touched)),m(),p("disabled",!a.valid)}},dependencies:[k,E,q,j,N,U,V,A,L,R,H],styles:["[_nghost-%COMP%]{display:block;font-family:Inter,sans-serif;background-color:#000;min-height:100vh;color:#fff}.forgot-password-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;padding:2rem;box-sizing:border-box;align-items:center;justify-content:center;position:relative}.logo-area[_ngcontent-%COMP%]{position:absolute;top:2rem;right:2rem;width:auto}.logo-area[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{height:40px;width:auto}@media(max-width:768px){.logo-area[_ngcontent-%COMP%]{display:none}}.content-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;max-width:400px;position:relative;padding-top:1rem}.back-link[_ngcontent-%COMP%]{position:absolute;top:2rem;left:2rem;display:flex;align-items:center;gap:.5rem;color:#aaa;text-decoration:none;font-size:.9rem;padding:0;background:transparent;border:none;cursor:pointer;transition:color .2s;z-index:100}.back-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px}.back-link[_ngcontent-%COMP%]:hover{color:#fff}@media(max-width:768px){.back-link[_ngcontent-%COMP%]{top:1rem;left:1rem}}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin-bottom:.5rem;text-align:center}.subtitle[_ngcontent-%COMP%]{color:#aaa;margin-bottom:2rem;text-align:center;font-size:.95rem}.otp-form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-wrapper[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#666;font-size:20px;pointer-events:none}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;background-color:#121212;border:1px solid #333333;border-radius:6px;padding:12px 12px 12px 40px;color:#fff;font-family:inherit;font-size:.95rem;outline:none;transition:border-color .2s;box-sizing:border-box}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#666}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#444}.input-wrapper[_ngcontent-%COMP%]   input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ff5252}.error-message[_ngcontent-%COMP%]{color:#ff5252;font-size:.75rem;margin-left:4px}.status-message[_ngcontent-%COMP%]{text-align:center;font-size:.9rem;padding:.8rem;border-radius:4px;margin-bottom:2rem;width:100%;box-sizing:border-box}.status-message.error[_ngcontent-%COMP%]{color:#ff5252;background-color:#ff52521a}.status-message.success[_ngcontent-%COMP%]{color:#4caf50;background-color:#4caf501a}.submit-btn[_ngcontent-%COMP%]{background-color:#fff;color:#000;border:none;border-radius:6px;padding:12px;font-size:1rem;font-weight:600;cursor:pointer;transition:opacity .2s}.submit-btn[_ngcontent-%COMP%]:hover{opacity:.9}.submit-btn[_ngcontent-%COMP%]:disabled{background-color:#555;color:#888;cursor:not-allowed;opacity:.7}"]})};export{D as ForgotPassword};
